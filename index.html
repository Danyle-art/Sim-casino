<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sim Casino Mobile</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0b0b0b">

    <style>
        :root {
            --gold: #d4af37;
            --red: #c41e3a;
            --black: #1a1a1a;
            --casino-green: #1a5e3a;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #0b0b0b; color: white;
            font-family: sans-serif; overflow: hidden; /* Prevent bouncing */
        }

        /* --- COMPACT MENU --- */
        #main-menu {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; padding: 10px; box-sizing: border-box;
        }
        .casino-title { font-size: 2rem; color: var(--gold); margin: 0; }
        .game-grid { display: flex; flex-direction: column; gap: 10px; width: 90%; margin-top: 20px; }
        .game-card {
            height: 80px; background: #222; border: 1px solid var(--gold);
            border-radius: 10px; display: flex; align-items: center; 
            padding: 0 20px; position: relative; overflow: hidden;
        }
        .game-card h3 { z-index: 2; margin: 0; font-size: 1.4rem; }
        .card-bg { position: absolute; right: 0; width: 50%; height: 100%; opacity: 0.4; background-size: cover; }

        /* --- GAME CONTAINERS --- */
        #game-view, #slots-view, #bj-view {
            display: none; flex-direction: column; align-items: center;
            height: 100vh; width: 100vw; padding-top: 50px; box-sizing: border-box;
        }
        .back-btn { position: absolute; top: 10px; left: 10px; padding: 8px; z-index: 100; background: #333; color: white; border: none; border-radius: 5px; }

        /* --- MOBILE SCALING LOGIC --- */
        .scaler {
            transform: scale(0.8); /* Default shrink */
            display: flex; flex-direction: column; align-items: center;
        }
        @media (max-width: 400px) { .scaler { transform: scale(0.65); } }

        /* Roulette Specific */
        .wheel-outer { width: 250px; height: 250px; border: 8px solid #444; border-radius: 50%; position: relative; margin-bottom: 10px; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; }
        .table-container { background: var(--casino-green); padding: 5px; border: 2px solid #5d4037; }
        .grid { display: grid; grid-template-columns: repeat(12, 28px); grid-template-rows: repeat(3, 35px); gap: 1px; background: white; }
        .cell { width: 28px; height: 35px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; background: var(--casino-green); position: relative;}
        .zero { width: 30px; border: 1px solid white; background: green; display: flex; align-items: center; justify-content: center; }

        /* Blackjack Specific */
        .bj-table { 
            width: 350px; height: 320px; background: green; border-radius: 150px 150px 20px 20px; 
            border: 8px solid #2b1d0e; display: flex; flex-direction: column; align-items: center; justify-content: space-around;
        }
        .card { width: 45px; height: 65px; background: white; color: black; border-radius: 4px; font-size: 12px; padding: 2px; }

        /* Controls */
        .controls { margin-top: 10px; display: flex; gap: 5px; }
        .spin-btn { background: var(--gold); border: none; padding: 10px 20px; font-weight: bold; border-radius: 5px; }
        .chip-selector { display: flex; gap: 5px; margin: 10px 0; }
        .chip-opt { width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; border: 2px solid transparent; }
        .chip-opt.selected { border-color: white; transform: scale(1.1); }
        .c5 { background: blue; } .c10 { background: red; } .c50 { background: green; }
    </style>
</head>
<body>

    <div id="main-menu">
        <h1 class="casino-title">SIM CASINO</h1>
        <div class="game-grid">
            <div class="game-card" onclick="startGame('roulette')">
                <div class="card-bg" style="background-image: url('roullette.jfif');"></div>
                <h3>ROULETTE</h3>
            </div>
            <div class="game-card" onclick="startGame('blackjack')">
                <div class="card-bg" style="background-image: url('blackjack.jfif');"></div>
                <h3>BLACKJACK</h3>
            </div>
            <div class="game-card" onclick="startGame('slots')">
                <div class="card-bg" style="background-image: url('slot_machine.jfif');"></div>
                <h3>SLOTS</h3>
            </div>
        </div>
    </div>

    <div id="game-view">
        <button class="back-btn" onclick="showMenu()">‚Üê BACK</button>
        <div class="scaler">
            <div id="msg">PLACE BETS</div>
            <div class="wheel-outer">
                <div id="wheel"></div>
                <div id="ball-track" style="position:absolute; width:100%; height:100%;"><div id="ball" style="position:absolute; width:10px; height:10px; background:white; border-radius:50%; top:40px; left:50%;"></div></div>
            </div>
            <div class="chip-selector">
                <div class="chip-opt c5 selected" onclick="selectChip(5, this)">5</div>
                <div class="chip-opt c10" onclick="selectChip(10, this)">10</div>
                <div class="chip-opt c50" onclick="selectChip(50, this)">50</div>
            </div>
            <div class="table-container">
                <div style="display:flex;">
                    <div class="zero" onclick="placeBet('number', 0, 'b-0')" id="b-0">0</div>
                    <div class="grid" id="grid"></div>
                </div>
            </div>
            <div class="controls">
                <button class="spin-btn" id="spin-btn" onclick="startSpin()">SPIN</button>
                <button class="spin-btn" style="background:#444" onclick="clearBets()">CLEAR</button>
            </div>
            <div style="margin-top:10px">Balance: <span class="bal-display">$1000</span></div>
        </div>
    </div>

    <div id="bj-view">
        <button class="back-btn" onclick="showMenu()">‚Üê BACK</button>
        <div class="scaler">
            <div id="bj-msg">DEAL TO START</div>
            <div class="bj-table">
                <div id="dealer-cards" style="display:flex; gap:5px; height:70px;"></div>
                <div id="player-cards" style="display:flex; gap:5px; height:70px;"></div>
            </div>
            <div class="controls">
                <div id="bj-controls">
                    <button class="spin-btn" onclick="startBJ()">DEAL ($50)</button>
                </div>
                <div id="bj-actions" style="display:none; gap:5px;">
                    <button class="spin-btn" onclick="bjHit()">HIT</button>
                    <button class="spin-btn" style="background:#444" onclick="bjStand()">STAND</button>
                </div>
            </div>
            <div style="margin-top:10px">Balance: <span class="bal-display">$1000</span></div>
        </div>
    </div>

    <div id="slots-view">
        <button class="back-btn" onclick="showMenu()">‚Üê BACK</button>
        <div class="scaler">
            <div id="slot-msg">READY</div>
            <div style="display:flex; gap:10px; background:#222; padding:20px; border:4px solid var(--gold); border-radius:10px;">
                <div id="s1" style="font-size:3rem">‚ùì</div>
                <div id="s2" style="font-size:3rem">‚ùì</div>
                <div id="s3" style="font-size:3rem">‚ùì</div>
            </div>
            <div class="controls">
                <button class="spin-btn" id="slot-spin-btn" onclick="startSlots()">SPIN ($10)</button>
            </div>
            <div style="margin-top:10px">Balance: <span class="bal-display">$1000</span></div>
        </div>
    </div>

    <script>
        // SERVICE WORKER
        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }

        // SHARED STATE
        let balance = 1000;
        let isSpinning = false;
        const reds = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
        const numbers = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
        
        function updateHUD() {
            document.querySelectorAll('.bal-display').forEach(el => el.innerText = `$${balance}`);
        }

        function showMenu() {
            document.getElementById('main-menu').style.display = 'flex';
            document.getElementById('game-view').style.display = 'none';
            document.getElementById('bj-view').style.display = 'none';
            document.getElementById('slots-view').style.display = 'none';
        }

        function startGame(game) {
            document.getElementById('main-menu').style.display = 'none';
            if(game === 'roulette') { document.getElementById('game-view').style.display = 'flex'; initRoulette(); }
            if(game === 'blackjack') { document.getElementById('bj-view').style.display = 'flex'; }
            if(game === 'slots') { document.getElementById('slots-view').style.display = 'flex'; }
            updateHUD();
        }

        // --- ROULETTE LOGIC ---
        let currentChip = 5; let bets = {};
        function initRoulette() {
            const wheel = document.getElementById('wheel');
            if(wheel.innerHTML !== "") return;
            numbers.forEach((n, i) => {
                const s = document.createElement('div');
                s.style.position = 'absolute'; s.style.width = '20px'; s.style.height = '50%';
                s.style.left = '50%'; s.style.marginLeft = '-10px'; s.style.transformOrigin = 'bottom center';
                s.style.transform = `rotate(${i * (360/37)}deg)`;
                s.innerHTML = `<span style="font-size:10px; color:${n===0?'#0f0':(reds.includes(n)?'#f22':'#fff')}">${n}</span>`;
                wheel.appendChild(s);
            });
            const grid = document.getElementById('grid');
            const nums = [3,6,9,12,15,18,21,24,27,30,33,36,2,5,8,11,14,17,20,23,26,29,32,35,1,4,7,10,13,16,19,22,25,28,31,34];
            nums.forEach(n => {
                const c = document.createElement('div');
                c.className = `cell ${reds.includes(n)?'red':'black'}`;
                c.style.background = reds.includes(n)?'#c41e3a':'#1a1a1a';
                c.innerText = n;
                c.onclick = () => placeBet('number', n, c);
                grid.appendChild(c);
            });
        }
        function selectChip(v, el) { currentChip = v; document.querySelectorAll('.chip-opt').forEach(o => o.classList.remove('selected')); el.classList.add('selected'); }
        function placeBet(type, val, el) {
            if(balance < currentChip) return;
            balance -= currentChip;
            bets[val] = (bets[val] || 0) + currentChip;
            el.style.border = "2px solid gold";
            updateHUD();
        }
        function clearBets() { 
            Object.values(bets).forEach(v => balance += v); bets = {}; 
            document.querySelectorAll('.cell').forEach(c => c.style.border = "none");
            updateHUD(); 
        }
        function startSpin() {
            if(isSpinning || Object.keys(bets).length === 0) return;
            isSpinning = true;
            const winIdx = Math.floor(Math.random()*37);
            const winNum = numbers[winIdx];
            const rot = 3600 + (winIdx * (360/37));
            document.getElementById('wheel').style.transition = 'transform 4s cubic-bezier(0.1,0,0.1,1)';
            document.getElementById('wheel').style.transform = `rotate(-${rot}deg)`;
            setTimeout(() => {
                let win = (bets[winNum] || 0) * 36;
                balance += win;
                document.getElementById('msg').innerText = `RESULT: ${winNum} (${win > 0 ? 'WIN' : 'LOSE'})`;
                isSpinning = false; bets = {};
                document.querySelectorAll('.cell').forEach(c => c.style.border = "none");
                updateHUD();
            }, 4000);
        }

        // --- BLACKJACK LOGIC ---
        let pHand = [], dHand = [];
        function startBJ() {
            if(balance < 50) return;
            balance -= 50; updateHUD();
            pHand = [Math.floor(Math.random()*10)+2, Math.floor(Math.random()*10)+2];
            dHand = [Math.floor(Math.random()*10)+2];
            document.getElementById('bj-actions').style.display = 'flex';
            document.getElementById('bj-controls').style.display = 'none';
            renderBJ();
        }
        function renderBJ() {
            const p = document.getElementById('player-cards'); p.innerHTML = '';
            pHand.forEach(v => { const c = document.createElement('div'); c.className='card'; c.innerText=v; p.appendChild(c); });
            const d = document.getElementById('dealer-cards'); d.innerHTML = '';
            dHand.forEach(v => { const c = document.createElement('div'); c.className='card'; c.innerText=v; d.appendChild(c); });
            const pSum = pHand.reduce((a,b)=>a+b,0);
            document.getElementById('bj-msg').innerText = `TOTAL: ${pSum}`;
            if(pSum > 21) endBJ("BUST!");
        }
        function bjHit() { pHand.push(Math.floor(Math.random()*10)+2); renderBJ(); }
        function bjStand() {
            while(dHand.reduce((a,b)=>a+b,0) < 17) dHand.push(Math.floor(Math.random()*10)+2);
            renderBJ();
            const ps = pHand.reduce((a,b)=>a+b,0), ds = dHand.reduce((a,b)=>a+b,0);
            if(ds > 21 || ps > ds) { balance += 100; endBJ("YOU WIN!"); }
            else if(ps === ds) { balance += 50; endBJ("PUSH"); }
            else endBJ("DEALER WINS");
        }
        function endBJ(m) {
            document.getElementById('bj-msg').innerText = m;
            document.getElementById('bj-actions').style.display = 'none';
            document.getElementById('bj-controls').style.display = 'block';
            updateHUD();
        }

        // --- SLOTS LOGIC ---
        function startSlots() {
            if(balance < 10) return;
            balance -= 10; updateHUD();
            const syms = ['üçí','üçã','7','üíé'];
            const r = [syms[Math.floor(Math.random()*4)], syms[Math.floor(Math.random()*4)], syms[Math.floor(Math.random()*4)]];
            document.getElementById('s1').innerText = 'üé∞'; document.getElementById('s2').innerText = 'üé∞'; document.getElementById('s3').innerText = 'üé∞';
            setTimeout(() => {
                document.getElementById('s1').innerText = r[0];
                document.getElementById('s2').innerText = r[1];
                document.getElementById('s3').innerText = r[2];
                if(r[0] === r[1] && r[1] === r[2]) { balance += 100; document.getElementById('slot-msg').innerText = "JACKPOT!"; }
                else { document.getElementById('slot-msg').innerText = "TRY AGAIN"; }
                updateHUD();
            }, 1000);
        }
    </script>
</body>
</html>
